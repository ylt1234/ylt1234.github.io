<!DOCTYPE html>
<html lang="en">
    <head>
        
    
    <link rel='stylesheet' href="/./css/dracula.css">

        <title>111</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=2.0">
<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="manifest" href="/site.webmanifest">

    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <header class="al_header al_pos_fixed">
    <div class="al_header_container dis_flex_jcenter">
        <div class="al_header_container_left">
            <div class="al_header_site_title">
                <a href="/">Hexo</a>
            </div>
        </div>

        <div class="dis_flex_jcenter">
            <div class="al_header_setting">
                <svg class="al_header_icon">
                    <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-menu"></use>
                </svg>
            </div>
        </div>
    </div>
</header>

        <div class="al_sidebar">

    <div class="al_sidebar_overlay al_full_cover"></div>

    <div class="al_pos_fixed al_sidebar_cnt">
        <div class="dis_flex_acenter al_sidebar_header">
            <h3>Hexo</h3>
            <div class="al_sidebar_close al_header_setting">
                <svg class="al_header_icon">
                    <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-close"></use>
                </svg>
            </div>
        </div>

        <div class="al_sidebar_author_cnt">

            <div class="al_sidebar_author_info">
                <h4>John Doe</h4>
                <img class="al_sidebar_avatar" src="https://yourAvatorURL">
                <p></p>
            </div>

            
        </div>
    </div>
</div>

        
    <div class="dis_flex_center al_lightbox_cnt al_full_cover">
        <img class="al_lightbox_img"/>
    </div>
    <div class="al_page_background dis_flex_center al_full_cover"></div>
    <div class="al_page_container">
        <div class="al_pos_ab al_fake_background"></div>
        <div class="al_main_container al_shadow al_main_page_container">
            <article class="al_article">
                <header>
                    <h1 class="al_page_title">
                        111
                    </h1>
                    <div class="al_page_info dis_flex">
                        <div class="al_page_content_info">
                            Wed July 12, 2023 10:48 AM
                        </div>

                        

                        
                        <span class="tags"></span>
                    </div>
                </header>

                
                    <div class="al_page_content_outline">
                        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E6%80%8E%E4%B9%88%E7%A1%AE%E5%AE%9A%E6%98%AF%E7%9C%9F%E5%AE%9E%E6%94%BB%E5%87%BB%E8%BF%98%E6%98%AF%E8%AF%AF%E6%8A%A5%EF%BC%9F"><span class="toc-text">（1）怎么确定是真实攻击还是误报？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E5%B8%B8%E7%94%A8%E7%9A%84Webshell%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7"><span class="toc-text">（3）常用的Webshell检测工具</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%884%EF%BC%89struts2%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="toc-text">（4）struts2命令执行的流量特征</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%885%EF%BC%89%E7%A1%AE%E5%AE%9A%E7%BA%A2%E9%98%9F%E5%9C%A8%E6%89%93%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E8%80%8C%E4%B8%94%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E6%98%AF%E4%B8%8D%E6%98%AFwebshell%EF%BC%9F"><span class="toc-text">（5）确定红队在打服务器，而且进行文件上传的操作，怎么判断是不是webshell？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%886%EF%BC%89Liunx%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%BB%BB%E4%BD%95%E6%9D%83%E9%99%90%E9%83%BD%E8%83%BD%E8%AE%BF%E9%97%AE%E7%9A%84%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E4%BD%8D%E7%BD%AE"><span class="toc-text">（6）Liunx系统中任何权限都能访问的临时文件位置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%887%EF%BC%89%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6"><span class="toc-text">（7）如何判断是钓鱼邮件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%888%EF%BC%89WAF%E5%92%8CIPS%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">（8）WAF和IPS的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%889%EF%BC%89%E8%B0%88%E8%B0%88%E8%9A%81%E5%89%91-x2F-%E8%8F%9C%E5%88%80-x2F-%E5%86%B0%E8%9D%8E-x2F-%E5%93%A5%E6%96%AF%E6%8B%89%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-text">（9）谈谈蚁剑&#x2F;菜刀&#x2F;冰蝎&#x2F;哥斯拉的特征</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%8810%EF%BC%89SQL%E6%B3%A8%E5%85%A5%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E7%89%B9%E5%BE%81%EF%BC%9F"><span class="toc-text">（10）SQL注入有哪些常见的特征？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%8811%EF%BC%89XSS%E5%BC%B9%E7%AA%97%E5%87%BD%E6%95%B0%E5%92%8C%E5%B8%B8%E8%A7%81%E7%9A%84XSS%E7%BB%95%E8%BF%87%E7%AD%96%E7%95%A5%EF%BC%9F"><span class="toc-text">（11）XSS弹窗函数和常见的XSS绕过策略？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%8812%EF%BC%89%E6%97%A0%E6%96%87%E4%BB%B6Webshell%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">（12）无文件Webshell实现的方式有哪些？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D%E5%87%A0%E7%A7%8D%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">介绍几种权限维持的方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%8A%A5%E8%AD%A6%E4%BA%86%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F%EF%BC%88%E5%8F%AF%E8%83%BD%E9%97%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%8D%E4%B8%80%E6%A0%B7%EF%BC%89"><span class="toc-text">内网报警了怎么办？（可能问的方式不一样）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E8%A2%AB%E6%8C%82%E9%A9%AC%E5%A6%82%E4%BD%95%E5%BA%94%E6%80%A5"><span class="toc-text">网站被挂马如何应急</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E4%B8%AD%E4%BA%86webshell%E6%80%8E%E6%A0%B7%E4%BB%8E%E6%97%A5%E5%BF%97%E6%89%BEwebshell%E4%BD%8D%E7%BD%AE%EF%BC%8C%E8%A2%AB%E6%8B%BFshell%E5%90%8E%E6%80%8E%E4%B9%88%E5%BA%94%E6%80%A5%EF%BC%8C%E6%80%8E%E6%A0%B7%E5%BF%AB%E9%80%9F%E5%AE%9A%E4%BD%8Dshell"><span class="toc-text">服务中了webshell怎样从日志找webshell位置，被拿shell后怎么应急，怎样快速定位shell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5%E5%85%B7%E4%BD%93%E6%B5%81%E7%A8%8B"><span class="toc-text">入侵排查具体流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E5%A4%87%E6%8A%A5%E8%AD%A6%EF%BC%8CSQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%8A%A5%E8%AD%A6%EF%BC%8C%E8%83%BD%E7%9C%8B%E5%88%B0%E6%94%BB%E5%87%BB%E6%97%B6%E9%97%B4%EF%BC%8C%E6%94%BB%E5%87%BBip%EF%BC%8Cpayload%EF%BC%8C%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E8%AF%AF%E6%8A%A5%E8%BF%98%E6%98%AF%E7%9C%9F%E6%98%AF%E6%94%BB%E5%87%BB%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%98%AF%E7%9C%9F%E5%AE%9E%E6%94%BB%E5%87%BB%EF%BC%8C%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E4%BB%96%E6%94%BB%E5%87%BB%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%88%90%E5%8A%9F%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86"><span class="toc-text">设备报警，SQL注入的报警，能看到攻击时间，攻击ip，payload，如何判断是误报还是真是攻击，如果是真实攻击，怎么判断他攻击是否成功，如果成功怎么处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F"><span class="toc-text">内网渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%81%E7%A8%8B%EF%BC%9A"><span class="toc-text">内网渗透流程：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-text">主机信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%9F%E5%86%85%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-text">域内信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%8E%AF%E5%A2%83%E4%B8%8D%E5%87%BA%E7%BD%91"><span class="toc-text">内网环境不出网</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BA%AF%E6%BA%90%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E4%BB%8B%E7%BB%8D"><span class="toc-text">溯源方法以及介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E6%BA%AF%E6%BA%90"><span class="toc-text">流量溯源</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E7%9A%84%E6%BA%AF%E6%BA%90"><span class="toc-text">实际情况的溯源</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="toc-text">应急响应</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sqlmap%E7%9A%84%E2%80%93os-shell%E5%8F%82%E6%95%B0%E5%8F%96%E5%BE%97shell"><span class="toc-text">sqlmap的–os-shell参数取得shell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87"><span class="toc-text">权限提升</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FOFA%E8%AF%AD%E6%B3%95"><span class="toc-text">FOFA语法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8E%86%E6%9C%89%E6%8A%A4%E7%BD%91%E7%BB%8F%E5%8E%86%EF%BC%8C%E4%BD%A0%E8%83%BD%E8%B0%88%E8%B0%88%E6%8A%A4%E7%BD%91%E7%9A%84%E6%83%85%E5%86%B5%E5%90%97"><span class="toc-text">简历有护网经历，你能谈谈护网的情况吗</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%93%9D%E9%98%9F%E7%A0%94%E5%88%A4"><span class="toc-text">蓝队研判</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E7%BB%99%E4%BD%A0%E4%B8%80%E4%B8%AA%E6%AF%94%E8%BE%83%E5%A4%A7%E7%9A%84%E6%97%A5%E5%BF%97%EF%BC%8C%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90"><span class="toc-text">5.给你一个比较大的日志，应该如何分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%A0%E8%83%BD%E5%A4%A7%E6%A6%82%E8%AF%B4%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%AF%94%E5%A6%82%E6%95%B0%E6%8D%AE%E5%8C%85%E6%88%96%E8%80%85%E6%97%A5%E5%BF%97%EF%BC%8C%E4%BD%A0%E7%9A%84%E5%88%86%E6%9E%90%E6%80%9D%E8%B7%AF%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">你能大概说一下，比如数据包或者日志，你的分析思路是什么</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%9C%89%E7%9C%8B%E8%BF%87%E7%9B%B8%E5%85%B3%E6%97%A5%E5%BF%97%E5%90%97"><span class="toc-text">2.文件上传和命令执行，有看过相关日志吗</span></a></li></ol>
                    </div>
                

                
                <section id="post-body">
                    <h1 id="（1）怎么确定是真实攻击还是误报？"><a href="#（1）怎么确定是真实攻击还是误报？" class="headerlink" title="（1）怎么确定是真实攻击还是误报？"></a>（1）怎么确定是真实攻击还是误报？</h1><p>通过设备的告警信息，流量特征（攻击特征），去查看数据包里面（请求包、请求体、返回包、返回体），是否存在相应的攻击特征，如果不包含攻击载荷，为误报<br>以攻击IP为索引，去查看（护网开始-现在），是否有其它攻击行为。<br>查看攻击方向：内对内、内对外、外对内。内对内的话误报率较大，但也要看具体的流量，最好上机排查。<br>本地复现：不用客户的网络去访问，可以用其他的网络，比如手机热点。</p>
<h1 id="（3）常用的Webshell检测工具"><a href="#（3）常用的Webshell检测工具" class="headerlink" title="（3）常用的Webshell检测工具"></a>（3）常用的Webshell检测工具</h1><p>D盾<br>河马WEBSHELL<br>Web shell Detector<br>PHP Malware Finder</p>
<h1 id="（4）struts2命令执行的流量特征"><a href="#（4）struts2命令执行的流量特征" class="headerlink" title="（4）struts2命令执行的流量特征"></a>（4）struts2命令执行的流量特征</h1><pre><code>一般Struts2框架的接口会以.do、.action结尾；struts2一些常见的关键字：memberAcecess,getRuntime,println,双引号，单引号，等号，括号之类的符号。
</code></pre>
<h1 id="（5）确定红队在打服务器，而且进行文件上传的操作，怎么判断是不是webshell？"><a href="#（5）确定红队在打服务器，而且进行文件上传的操作，怎么判断是不是webshell？" class="headerlink" title="（5）确定红队在打服务器，而且进行文件上传的操作，怎么判断是不是webshell？"></a>（5）确定红队在打服务器，而且进行文件上传的操作，怎么判断是不是webshell？</h1><p>一般webshell文件名后缀为jsp、php、py、asp等；<br>上传的文件如果是被加密的，可能是webshell,因为正常的操作一般不会上传脚本文件，加密的原因是因为过查杀，正常文件是不需要过查杀的。<br>由于webshell内需要执行对应的功能，例如命令执行，连接数据库等，所以文件内容中会存在相关的函数关键字，如：Runtime.getRuntime()、eval()、system、request()等<br>一般webshell里可能有对应的访问控制，所以内容中可能会包含username、password字样。</p>
<h1 id="（6）Liunx系统中任何权限都能访问的临时文件位置"><a href="#（6）Liunx系统中任何权限都能访问的临时文件位置" class="headerlink" title="（6）Liunx系统中任何权限都能访问的临时文件位置"></a>（6）Liunx系统中任何权限都能访问的临时文件位置</h1><pre><code> 答：/var/tmp
</code></pre>
<h1 id="（7）如何判断是钓鱼邮件"><a href="#（7）如何判断是钓鱼邮件" class="headerlink" title="（7）如何判断是钓鱼邮件"></a>（7）如何判断是钓鱼邮件</h1><p>以公司某部门的名义，如安全部、综合部，使用正式的语气，内容涉及到账号和密码等敏感信息，可能带有链接地址或附件，制造紧张氛围，比如24小时内今日下班前完整账号密码修改。<br>看发件人 设备上也会报IP 上微步查一下IP是不是恶意IP 邮件的发件人和内容是不是正常的业务往来<br>附件放到沙箱里 看看是否有问题<br>有的邮件会提示你邮件由另一个邮箱代发，或者邮箱地址不是本公司的，再或者邮箱地址是qq或者163等个人邮箱的，那就更没跑了</p>
<h1 id="（8）WAF和IPS的区别"><a href="#（8）WAF和IPS的区别" class="headerlink" title="（8）WAF和IPS的区别"></a>（8）WAF和IPS的区别</h1><p>   答：IPS位于防火墙和网络的设备之间，防火墙可以拦截底层攻击行为，但对应用层     的深层攻击行为无能为力。IPS是对防火墙的补充。综合能力更强一些；WAF是工作在应用层的防火墙，主要对web请求&#x2F;响应进行防护。</p>
<h1 id="（9）谈谈蚁剑-x2F-菜刀-x2F-冰蝎-x2F-哥斯拉的特征"><a href="#（9）谈谈蚁剑-x2F-菜刀-x2F-冰蝎-x2F-哥斯拉的特征" class="headerlink" title="（9）谈谈蚁剑&#x2F;菜刀&#x2F;冰蝎&#x2F;哥斯拉的特征"></a>（9）谈谈蚁剑&#x2F;菜刀&#x2F;冰蝎&#x2F;哥斯拉的特征</h1><p>蚁剑AntSword:支持自定义加密，但shell不稳定，且对JSP兼容性比较差；特征码为data:(“display_errors” AND “set_time_limit(0)”) agent:”antSword&#x2F;v2.0”<br>菜刀：流量Base64编码，特征比较固定。特征码：base64_decode”;eval;z0<br>冰蝎Behinder：流量动态AES加密，一般http包头中 content-type为application&#x2F;octet-stream；若发现有冰蝎Webshell文件上传的告警事件，可根据数据包中的上传路径以登录服务器排查文件的方式进一步确认冰蝎 WebShell 是否被上传成功。若访问发现相关文件存在，确认 WebShell 成功上传到了服务器。<br>哥斯拉Godzilla：基于流量、HTTP全加密的webshell工具，看不出有明显的攻击特征，需要结合流量找到哥斯拉webshell上传成功的流量来进行分析和判断，另外该工具自带了 一些插件模块，实现了写无文件 WebShell 等强大的功能，可以伪造UA头和Accept头，消除请求包和响应包中的特征。</p>
<h1 id="（10）SQL注入有哪些常见的特征？"><a href="#（10）SQL注入有哪些常见的特征？" class="headerlink" title="（10）SQL注入有哪些常见的特征？"></a>（10）SQL注入有哪些常见的特征？</h1><p>一些常见的关键字：select,where、order、union、update、floor、exec、information_schema、extractvalue、delete、insert、ascii、table、from等<br>一些常见的sql函数：user()、@@version、ctxsys.drithsx.sn()等针对双引号、单引号、等号之类的符号，可能会进行相关的编码操作，例如url编码，需要注意。</p>
<h1 id="（11）XSS弹窗函数和常见的XSS绕过策略？"><a href="#（11）XSS弹窗函数和常见的XSS绕过策略？" class="headerlink" title="（11）XSS弹窗函数和常见的XSS绕过策略？"></a>（11）XSS弹窗函数和常见的XSS绕过策略？</h1><p>弹窗函数：alert、confirm、prompt、onclick<br>绕过策略：大小写混写；双写；&lt;img&#x2F;src&#x3D;1&gt;；%0a或者%0d绕过；拼凑绕过</p>
<h1 id="（12）无文件Webshell实现的方式有哪些？"><a href="#（12）无文件Webshell实现的方式有哪些？" class="headerlink" title="（12）无文件Webshell实现的方式有哪些？"></a>（12）无文件Webshell实现的方式有哪些？</h1><p>基于servlet规范，通过动态注册Servlet、Filter、Listener等实现无文件webshell<br>基于特定框架，如 Spring 框架下动态注册 Controller 等。<br>基于 JAVA Agent，如 memShell</p>
<h1 id="介绍几种权限维持的方法"><a href="#介绍几种权限维持的方法" class="headerlink" title="介绍几种权限维持的方法"></a>介绍几种权限维持的方法</h1><p>匿名用户<br>PHP内存型木马<br>Shift 后门<br>放大镜后门<br>user.ini文件构成的PHP后门<br>注册表开机自动启动项<br>DLL 劫持<br>计划任务</p>
<h1 id="内网报警了怎么办？（可能问的方式不一样）"><a href="#内网报警了怎么办？（可能问的方式不一样）" class="headerlink" title="内网报警了怎么办？（可能问的方式不一样）"></a>内网报警了怎么办？（可能问的方式不一样）</h1><p>首先就要是地位到具体的那一台机器，既然报警那就说明知道了具体的漏洞类型，加相应的补丁打上，以linux为主（一般都会问linux的），查看&#x2F;var&#x2F;log&#x2F;secure系统日志，查看登录失败的记录，还有Linux历史命令–&gt;home目录的bash_histor，查看执行过的命令。</p>
<p>在利用webshell或者是shell查杀工具查杀，查看tmp目录下是非有带有免杀的木马。彻底清除。再到全流量分析的机子上看，是非有经过其他的机器。</p>
<p>拿到攻击ip之后到线上的一些网站查看主机类型，比如360或者微步上，查看是非是傀儡机，vps跳板，或者是国内个人云主机。</p>
<p>如果是个人云主机，就可以通过whois查看是非有最近绑定的域名，或者绑定者的邮箱。</p>
<p>知道邮箱之后就可以反查询出qq号说多少，再利用社工查询到手机号，到一个知名的网站上查询这个手机号有没有注册过什么网站，可以去这些网站通过撞库的方法登入，这样就可以拿到这个攻击者的身份证，学校，地址这些了。<br>（思路是应急响应-&gt;加固-&gt;溯源</p>
<h1 id="网站被挂马如何应急"><a href="#网站被挂马如何应急" class="headerlink" title="网站被挂马如何应急"></a>网站被挂马如何应急</h1><p> 1.取证，登录服务器，备份，检查服务器敏感目录，查毒（搜索后门文件-注意文件的时间， 用户，后缀等属性），调取日志（系统，中间件日志，WAF日志等）；<br> 2.处理，恢复备份（快照回滚最近一次），确定入侵方法（漏洞检测并进行修复）<br> 3.溯源，查入侵IP，入侵手法（网路攻击事件）的确定等<br> 4.记录，归档——–预防-事件检测-抑制-根除-恢复-跟踪-记录通用漏洞的应对等其他 安全应急事件 </p>
<h1 id="服务中了webshell怎样从日志找webshell位置，被拿shell后怎么应急，怎样快速定位shell"><a href="#服务中了webshell怎样从日志找webshell位置，被拿shell后怎么应急，怎样快速定位shell" class="headerlink" title="服务中了webshell怎样从日志找webshell位置，被拿shell后怎么应急，怎样快速定位shell"></a>服务中了webshell怎样从日志找webshell位置，被拿shell后怎么应急，怎样快速定位shell</h1><p>从日志 流量 文件开始，先定位位置 查看敏感目录 tmp usr&#x2F;sbin etc&#x2F;ssh ，对新创建文件，修改文件等进行查看，找特殊权限文件 比如777 。流量的话 从ua和playload去分析。比如菜刀连jsp木马：第一个参数是a-q，这个是不会变的，第二个是编码，第三个是 playload。日志的话从找到的shell时间点去关联分析，可以还原攻击手法<br>快速定位 就是看进程和内存 看占用时间长和占用率高的 </p>
<h1 id="入侵排查具体流程"><a href="#入侵排查具体流程" class="headerlink" title="入侵排查具体流程"></a>入侵排查具体流程</h1><p>1、检查系统账号安全查看服务器是否有弱口令，远程管理端口是否公开查看服务器是否有可疑账号：cmd输入lusrmgr.msc命令查看服务器是否存在隐藏账号、克隆账号结合日志，查看管理员登录时间，用户名是否存在异常</p>
<p>2、检查异常端口、进程 检查端口连接情况，是否有远程连接、可疑连接：a、netstat -ano 查看目前的网络连接，定位可疑的ESTABLISHEDb、根据netstat 定位出的pid，再通过tasklist命令进行进程定位 tasklist | findstr “PID”</p>
<p>3、检查启动项、计划任务、服务win+r：输入msconfig，查看异常启动项win+r：输入regedit，打开注册表，查看开机启动项</p>
<p>4、检查系统相关信息win+r：输入systeminfo查看系统信息</p>
<p>5、日志分析win+r：输入eventvwr.msc,打开事件查看器导出应用程序日志，安全日志，系统日志，利用log parser分析 </p>
<h1 id="设备报警，SQL注入的报警，能看到攻击时间，攻击ip，payload，如何判断是误报还是真是攻击，如果是真实攻击，怎么判断他攻击是否成功，如果成功怎么处理"><a href="#设备报警，SQL注入的报警，能看到攻击时间，攻击ip，payload，如何判断是误报还是真是攻击，如果是真实攻击，怎么判断他攻击是否成功，如果成功怎么处理" class="headerlink" title="设备报警，SQL注入的报警，能看到攻击时间，攻击ip，payload，如何判断是误报还是真是攻击，如果是真实攻击，怎么判断他攻击是否成功，如果成功怎么处理"></a>设备报警，SQL注入的报警，能看到攻击时间，攻击ip，payload，如何判断是误报还是真是攻击，如果是真实攻击，怎么判断他攻击是否成功，如果成功怎么处理</h1><p> 先看ip，如果ip是公司内部的再看内部人员有没有相关操作，如果不是公司人员业务的操作那就是攻击了，<br> 然后分析payload,分析它写的payload安全设备能否它进行过滤拦截，如果它确实能绕过，那就应该攻击成功了，<br> 成功的话赶紧上报，做应急响应，做出相应处理，添加过滤规则，修改数据库中能修改的数据比如管理员账号密码啥的 </p>
<h1 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h1><h2 id="内网渗透流程："><a href="#内网渗透流程：" class="headerlink" title="内网渗透流程："></a>内网渗透流程：</h2><p> 拿到跳板后，先探测一波内网存活主机，用net user &#x2F;domian命令查看跳板机是否在域内，探测存活主机、提权、提取hash、进行横向移动，定位dc位置，查看是否有能直接提权域管的漏洞，拿到dc控制权后进行提权，然后制作黄金票据做好维权，清理一路过来的日志擦擦脚印</p>
<p>信息收集</p>
<h2 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h2><p>1.网络配置 ipconfig &#x2F;all<br>2.操作系统 systeminfo | findstr &#x2F;B &#x2F;C:”OS 名称” &#x2F;C:”OS 版本”<br>3.软件信息 systeminfo | findstr &#x2F;B &#x2F;C:”OS Name” &#x2F;C:”OS Version”<br>4.服务信息 wmic &#x2F;namespace:\root\securitycenter2 path antivirusproduct GET displayName,productState, pathToSignedProductExe<br>5.用户列表 net user<br>6.本地管理员信息 net localgroup administrators<br>7.端口信息 netstat –ano<br>8.补丁信息 wmic qfe get Caption,Description,HotFixID,InstalledOn<br>9.查防火墙 netsh firewall show config</p>
<h2 id="域内信息收集"><a href="#域内信息收集" class="headerlink" title="域内信息收集"></a>域内信息收集</h2><p>是否有域 使用ipconfig &#x2F;all命令可以查看网关IP地址、DNS的IP地址以及判断当前主机 是否在域内：通过反 向解析查询命令nslookup来解析域名的IP地址，使用解析出来的IP地 址进行对比，判断域控制器和 DNS服务器是否在同一台服务器上<br>登录域信息 net config workstation 域内信息收集<br>ICMP探测内网 for &#x2F;L %I in (1,1,254) DO <span class="label label-primary">@ping</span> -w 1 -n 1 192.168.174.%I | findstr “TTL&#x3D;”<br>ARP探测内网<br>端口信息收集<br>查询域信息 net view &#x2F;domain<br>查询域主机 net view &#x2F;domain:XXX<br>查询域用户 net group &#x2F;domain<br>查找域控 Nslookup -type&#x3D;SRV _ldap._tcp net time &#x2F;domain net group “Domain Controllers” &#x2F;domain<br>查域用户信息 net user &#x2F;domain<br>查询域管理员 net group “Domain Admins” &#x2F;domain<br>查询域sid信息 whoami &#x2F;all</p>
<h2 id="内网环境不出网"><a href="#内网环境不出网" class="headerlink" title="内网环境不出网"></a>内网环境不出网</h2><p>1.通过webshell实现内网socket代理</p>
<p>2.正向链接 </p>
<p>3.ssh隧道 </p>
<p>4.协议不同出网的方式不同，如dns对应dnscat2 tcp对应 </p>
<p>5.测试是否是特定协议或端口出网 </p>
<h1 id="溯源方法以及介绍"><a href="#溯源方法以及介绍" class="headerlink" title="溯源方法以及介绍"></a>溯源方法以及介绍</h1><p>溯源方法<br>攻击源捕获——溯源处置——攻击者画像<br>攻击源捕获来源<br>1.审查邮件钓鱼<br>2.获取安全设备数据进行分析，特别是流量数据；<br>3.网络资产所在的服务器运行状态；<br>4.中间件日志信息查看；<br>5.合理运用蜜罐系统进行溯源追踪。<br>溯源处置<br>1.域名查询<br>2.IP查询<br>3.身份查询<br>4.文件查询<br>攻击者画像<br>1.攻击路径<br>2.攻击目的<br>3.网络代理<br>4.攻击手法<br>5.攻击者的身份画像，由四个部分组成，分别是：<br>虚拟身份：ID、昵称、网名<br>真实身份：姓名、家庭&#x2F;办公物理位置<br>联系方式：手机号、QQ&#x2F;微信、邮箱<br>组织情况：单位名称、职位信息</p>
<h1 id="流量溯源"><a href="#流量溯源" class="headerlink" title="流量溯源"></a>流量溯源</h1><p>可利用流量工具 wireshark 进行溯源：</p>
<p>查看 eval、 z0、 shell whoami 等关键字，查看出现次数过多的时候， 需要查看是哪个页面发起的请求，有可能是 webshell</p>
<p>通过 WireShark 工具快速搜索关键字，定位到异常流量包</p>
<p>找出异常 IP 和所上传的内容，查看是否为 webshell</p>
<p>如何定位到攻击IP：</p>
<p>首先通过选择 - 统计 - 对话查看流量的走向情况， 定位可疑的 IP 地址</p>
<p>根据定位到的 IP 地址，尝试对上传的 webshell 进行定位</p>
<p>ip.addr &#x3D;&#x3D; ip &amp;&amp; http matches<br>“uploadllevallselectlxp_cmdshell” &amp;&amp; http.request.method &#x3D;&#x3D; “POST”<br>查找到 webshell 后尝试溯源漏洞位置</p>
<p>http.request.uri contains “webshell.php”<br>定位到最开始 webshell 执行或上传的时候<br>根据最开始的 HTTP 上传包或者其他漏洞特征定位漏洞类型</p>
<h1 id="实际情况的溯源"><a href="#实际情况的溯源" class="headerlink" title="实际情况的溯源"></a>实际情况的溯源</h1><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/fevents/334657.html">https://www.freebuf.com/fevents/334657.html</a></p>
<h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><p><a target="_blank" rel="noopener" href="https://raspy-move-01d.notion.site/bedcc90d250f46219dded510ef76b49b?v=337a42cfe45b4bdda28ffeec8ce26cf7">https://raspy-move-01d.notion.site/bedcc90d250f46219dded510ef76b49b?v=337a42cfe45b4bdda28ffeec8ce26cf7</a></p>
<h1 id="sqlmap的–os-shell参数取得shell"><a href="#sqlmap的–os-shell参数取得shell" class="headerlink" title="sqlmap的–os-shell参数取得shell"></a>sqlmap的–os-shell参数取得shell</h1><p>本质：写入两个 php 文件，其中的一个可以让我们用来执行命令，而另外一个可以让我们可以上传文件。<br>执行条件有三个：<br>1）网站必须是root权限<br>2）攻击者需要知道网站的绝对路径<br>3）GPC为off，php主动转义的功能关闭</p>
<h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><p>a、mysql提权，udf提权，mof提权，serv-u提权，oracle提权<br>b、windows 溢出提权<br>c、linux脏牛,内核漏洞提权 日志清理 总结报告及修复方案</p>
<h1 id="FOFA语法"><a href="#FOFA语法" class="headerlink" title="FOFA语法"></a>FOFA语法</h1><p>查询指定cms的管理系统：app&#x3D;”cms”<br>domain&#x3D; 搜索根域名带有xx的网站。例：domain&#x3D;“baidu.com”<br>host&#x3D;从url中搜索网站注意搜索要用host作为名称。例：host&#x3D; “.edu.cn”<br>port&#x3D; 查找对应443端口的资产。例：port&#x3D;3389<br>protocol&#x3D; 搜索制定协议类型(在开启端口扫描的情况下有效)。例：protocol&#x3D;ssh cert&#x3D;搜索证书(https或者imaps等)中带有域名的资产。例：cert&#x3D;baidu.com<br>banner&#x3D; 搜索协议中带有账户文本的资产。例：banner&#x3D;users &amp;&amp; protocol&#x3D;ftp<br>type&#x3D;搜索所有协议资产，支持subdomain和service两种。例：type&#x3D;servicce<br>server&#x3D;&#x3D; 搜索服务器、中间件名称。例：server&#x3D;apache<br>高级语法需要用管道符连接如：‘|| ‘ ‘&amp;&amp;’，如下：<br>body&#x3D;”后台”&amp;&amp;domain&#x3D;”xxx.com” 查询指定域名的后台<br>Header&#x3D;”Hikvision” 找摄像头</p>
<h1 id="简历有护网经历，你能谈谈护网的情况吗"><a href="#简历有护网经历，你能谈谈护网的情况吗" class="headerlink" title="简历有护网经历，你能谈谈护网的情况吗"></a>简历有护网经历，你能谈谈护网的情况吗</h1><p>参加过护网蓝队，负责事件研判工作，主要使用 ips，ids 等设备做流量监控与日志分析工作判断安全事件是否为误判</p>
<p>监控、研判、处置、溯源</p>
<p>对安全管理中心发出的态势排查单进行排查，并将排查结果反馈给安全管理中心，对安全管理中心发出的封堵工单和解封工单进行对应的封堵与解封，每两小时反馈一次排查结果、设备巡检报告、封堵情况。查看呼池 DDOS 设备，记录并排查告警信息</p>
<h1 id="蓝队研判"><a href="#蓝队研判" class="headerlink" title="蓝队研判"></a>蓝队研判</h1><p>研判工作要充分利用已有安全设备（需要提前了解客户的网络拓扑以及部署设备情况），分析其近期的设备告警，将全部流量日志（日志条件：源地址，目的地址，端口，事件名称，时间，规则 ID，发生 次数等）根据研判标准进行筛选（像挖矿、蠕虫、病毒、拒绝服务这类不太可能为攻击方发起的攻击的事件，直接过滤掉，减少告警数量），一般情况下，真实攻击不可能只持续一次，它一定是长时间、周期性、多 IP 的进行攻击</p>
<p>对于告警结合威胁情报库如：微步、奇安信威胁情报中心、绿盟威胁情报云等对于流量日志的原 IP 地址进行分析，判断其是否为恶意攻击，推荐使用微步的插件，如果确认为攻击行为或者不能确认是否为攻击行为，进行下一步操作，在之前准备好的表格中查找 IP 是否为客户内网部署的设备，如果不是，继续进行下一步，在事件上报平台查看是否有其他人提交过，如果没有，则上报</p>
<p>然后根据流量日志，对请求数据包和返回数据包分析判断其是否为误报，需要留意 X-Forwarded-For（简称XFF）和 x-real-ip 可以了解些 webshell 工具的流量特征，尤其是免杀 webshell，有可能不会被设备识别</p>
<p>最后上报事件时，尽可能提供完整的截图，包括源 ip、目的ip，请求包请求体，响应包响应体等重要信息，以方便后续人员研判溯源</p>
<h1 id="5-给你一个比较大的日志，应该如何分析"><a href="#5-给你一个比较大的日志，应该如何分析" class="headerlink" title="5.给你一个比较大的日志，应该如何分析"></a>5.给你一个比较大的日志，应该如何分析</h1><p>攻击规则匹配，通过正则匹配日志中的攻击请求</p>
<p>统计方法，统计请求出现次数，次数少于同类请求平均次数则为异常请求</p>
<p>白名单模式，为正常请求建立白名单，不在名单范围内则为异常请求</p>
<p>HMM 模型，类似于白名单，不同点在于可对正常请求自动化建立模型，从而通过正常模型找出不匹配者则为异常请求</p>
<p>借助日志分析工具</p>
<p>如 LogForensics 腾讯实验室 <a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/opensource/detail/15">https://security.tencent.com/index.php/opensource/detail/15</a></p>
<h1 id="你能大概说一下，比如数据包或者日志，你的分析思路是什么"><a href="#你能大概说一下，比如数据包或者日志，你的分析思路是什么" class="headerlink" title="你能大概说一下，比如数据包或者日志，你的分析思路是什么"></a>你能大概说一下，比如数据包或者日志，你的分析思路是什么</h1><p>用流量监测的安全设备，比如天眼，查看报文，分析报文里和 host 和网站目录路径，查看是否可疑，使用微步查询 host 是否为恶意，使用 wireshark 对数据包深度分析</p>
<p>看一下请求的网站路径，源 IP 与目的 IP 地址，host 字段的值以及发包内容等</p>
<p>工具有 wireshark，网站的话微步在线等威胁情报中心</p>
<h1 id="2-文件上传和命令执行，有看过相关日志吗"><a href="#2-文件上传和命令执行，有看过相关日志吗" class="headerlink" title="2.文件上传和命令执行，有看过相关日志吗"></a>2.文件上传和命令执行，有看过相关日志吗</h1><p>文件：可能在系统有上传功能或者有文本编辑器，看一下是否有 base64 加密或者 url 加密，解码验证一下是否有恶意代码</p>
<p>系统日志：有没有 web 容器做了一些危险行为，比如 bash 反弹 shell 等</p>
<p>网络应用日志：有没有异常的网站文件，类似 webshell 等，就有可能是命令执行</p>

                </section>

                
                

                

            </article>

            
            <nav class="dis_flex al_post_nav">
                <a class="al_post_nav_item dis_flex_acenter" href="/">
                    
                </a>
                <a class="al_post_nav_item dis_flex_acenter" href="/2023/07/11/buuctf-3/">
                    
                        <span class="al_text_ellipsis al_post_nav_desc">buuctf-3</span>
                        <svg class="al_arrow">
                            <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-arrow-right"></use>
                        </svg>
                    
                </a>
            </nav>
        </div>
    </div>


        <div class="al_index_footer dis_flex_center">
    <div class="al_index_footer_item al_index_footer_title">
        John Doe
    </div>

    
    

    <div class="al_index_footer_item al_index_footer_extra">
        Created By 
        <a target="_blank" rel="noopener" href="https://github.com/iGuan7u/Acetolog">AcetoLog</a>
         · Power By 
        <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
    </div>

    <div class="al_index_footer_item al_index_footer_extra_right">
        All Right Reserved
    </div>
</div>

        <script type="text/javascript" async="async" src="/javascripts/acelog.js"></script>
        
        
        
        
        

    </body>
</html>